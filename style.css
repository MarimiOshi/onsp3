/* ================================================================== */
/* style.css - ONSP Project (Tinder-like UI, Simplified, Full CSS)  */
/* ================================================================== */

:root {
    --member-accent-color: #FF6B6B; /* デフォルトのアクセントカラー (例: ピンク系) */
    --global-bg-color: #121212;     /* 全体背景は非常に暗いグレー */
    --card-bg-color: #1E1E1E;       /* カード背景 */
    --text-color-primary: #E0E0E0;   /* メインの文字色 (明るいグレー) */
    --text-color-secondary: #A0A0A0; /* サブの文字色 (やや暗いグレー) */
    --fever-gauge-bg: #333;
    --fever-gauge-fill: var(--member-accent-color); /* フィーバーゲージの色 */
    --like-overlay-color: rgba(76, 175, 80, 0.7);  /* シコい!! (緑系半透明) */
    --nope-overlay-color: rgba(244, 67, 54, 0.7);  /* 萎え (赤系半透明) */

    --bottom-controls-height: 70px; /* 下部操作ボタンエリアの高さ */
    --serif-area-height: 70px;     /* セリフエリアの高さ */
    --side-panel-width: 60px;
    --standard-mode-max-width: 700px; /* (カウンターモードは廃止だが念のため) */
}

html { height: 100%; box-sizing: border-box; }
*, *:before, *:after { box-sizing: inherit; }

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    margin: 0; background-color: var(--global-bg-color); color: var(--text-color-primary);
    line-height: 1.4;
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
    display: flex; flex-direction: column;
    height: 100vh; height: 100svh; overflow: hidden; position: relative;
}

/* スクロールバー */
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: #101010; }
::-webkit-scrollbar-thumb { background-color: #333; border-radius: 2px; }
body { scrollbar-width: thin; scrollbar-color: #333 #101010; }

/* メインコンテンツエリア */
.app-main-content { flex-grow: 1; width: 100%; height: 100%; overflow: hidden; position: relative; }
.mode-section { display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden; background-color: var(--global-bg-color); }
.mode-section.active { display: flex; flex-direction: column; }


/* --- しこしこモード (Tinder風カードUI) --- */
.shikoshiko-layout-container {
    width: 100%; height: 100%; display: flex; flex-direction: column;
    position: relative;
    background-color: var(--global-bg-color); /* カード外の背景 */
}

.shikoshiko-box1 { /* カードスタックとサイドパネルを含むエリア */
    flex-grow: 1; position: relative; display: flex;
    align-items: center; justify-content: center; overflow: hidden;
    padding: 10px; /* カード周囲の余白 */
}

.card-stack-area {
    width: 100%; height: 100%;
    max-width: 400px; /* カードの最大幅 */
    max-height: 600px; /* カードの最大高さ */
    position: relative;
    perspective: 1000px;
    margin: auto;
}

.card {
    width: 100%; height: 100%;
    background-color: var(--card-bg-color);
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    position: absolute;
    top: 0; left: 0;
    overflow: hidden;
    display: flex; flex-direction: column;
    transform-origin: center bottom;
    transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    cursor: grab;
    user-select: none;
    will-change: transform, opacity;
}
.card.dragging { transition: none; cursor: grabbing; }
.card.removing-left { transform: translateX(-150%) rotate(-30deg) !important; opacity: 0 !important; }
.card.removing-right { transform: translateX(150%) rotate(30deg) !important; opacity: 0 !important; }

.card-image-area {
    flex-grow: 1; position: relative; overflow: hidden;
    border-top-left-radius: 15px; border-top-right-radius: 15px;
}
.card-image-area img { width: 100%; height: 100%; object-fit: cover; display: block; }
.card-image-area .image-error-placeholder {
    width: 100%; height: 100%; background-color: #2a2a2e;
    display: flex; align-items: center; justify-content: center;
    color: #777; font-size: 0.9rem;
}

.card-info-area {
    padding: 10px 15px;
    background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%);
    position: absolute;
    bottom: 0; left: 0; right: 0;
    color: #fff;
    border-bottom-left-radius: 15px; border-bottom-right-radius: 15px;
}
.card-info-area .member-quote {
    font-size: 0.9rem; font-weight: 500; margin: 0 0 5px 0;
    max-height: 2.8em; line-height: 1.4;
    overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;
    text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
}
.card-info-area .image-tags-container {
    font-size: 0.65rem; opacity: 0.8; text-align: left;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.card-info-area .image-tag-item {
    background-color: rgba(255,255,255,0.15); color: #eee;
    padding: 1px 5px; margin-right: 4px; border-radius: 3px;
}

.swipe-overlay {
    position: absolute; top: 30px;
    padding: 8px 15px; border-radius: 8px;
    font-size: 1.8rem; font-weight: bold; color: #fff;
    border: 3px solid #fff;
    text-transform: uppercase;
    opacity: 0;
    transform: rotate(0deg) scale(0.8);
    transition: opacity 0.1s ease-out, transform 0.1s ease-out;
    pointer-events: none;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}
.swipe-overlay.like { left: 20px; background-color: var(--like-overlay-color); transform: rotate(-15deg) scale(1); }
.swipe-overlay.nope { right: 20px; background-color: var(--nope-overlay-color); transform: rotate(15deg) scale(1); }
.card.show-like-overlay .swipe-overlay.like,
.card.show-nope-overlay .swipe-overlay.nope { opacity: 1; }


.side-info-panel.left-panel {
    position: absolute; left: 10px;
    /* 下部コントロールとセリフエリアの高さを考慮してbottomを調整 */
    bottom: calc(var(--serif-area-height) + var(--bottom-controls-height) + 20px + env(safe-area-inset-bottom));
    display: flex; flex-direction: column; align-items: center; gap: 15px; z-index: 20;
}
.profile-icon-wrapper { width: 45px; height: 45px; border-radius: 50%; overflow: hidden; border: 2px solid var(--member-accent-color); background-color: #333; }
.profile-icon { width: 100%; height: 100%; object-fit: cover; }
.action-icon-button { background: none; border: none; color: var(--global-text-color); cursor: pointer; text-align: center; padding: 0; font-size: 28px; opacity: 0.8; transition: opacity 0.2s, transform 0.2s; }
.action-icon-button:hover { opacity: 1; transform: scale(1.1); }
.action-icon-button.like-button .icon-display {}
.action-icon-button.weak-point-button .icon-display { color: rgba(255,255,255,0.7); }
.action-icon-button.weak-point-button.is-weak .icon-display { color: #ffd700; }
.fever-gauge-container-vertical {
    width: 8px; height: 80px; background-color: var(--fever-gauge-bg);
    border-radius: 4px; overflow: hidden; position: relative;
    border: 1px solid rgba(255,255,255,0.2);
}
.fever-gauge-bar-vertical {
    width: 100%; height: 0%;
    background-color: var(--fever-gauge-fill);
    position: absolute; bottom: 0; left: 0;
    transition: height 0.3s ease-out, background-color 0.3s ease-out;
}

.settings-button-右上 { position: absolute; top: 15px; right: 15px; z-index: 30; background: rgba(0,0,0,0.5); border: none; color: var(--global-text-color); font-size: 1.5rem; padding: 8px 10px; border-radius: 50%; cursor: pointer; }
.settings-button-右上:hover { background: rgba(0,0,0,0.7); }

.serif-animation-container { /* セリフ専用エリアに変更 */
    flex-shrink: 0; height: var(--serif-area-height);
    background-color: rgba(0,0,0,0.7); /* カード下部と似た背景 */
    color: var(--global-text-color);
    display: flex; align-items: center; justify-content: center;
    padding: 0 15px;
    border-top: 1px solid rgba(255,255,255,0.1);
    /* アニメーションエリアは廃止したので、このコンテナはセリフ専用 */
}
.serif-area { width: 100%; text-align: center; }
/* .animation-area は廃止 */

.shikoshiko-box2-controls-only { /* 下部操作ボタン専用エリア */
    flex-shrink: 0;
    background-color: var(--global-bg-color);
    padding-top: 5px;
    border-top: 1px solid #222;
}
.main-controls { display: flex; justify-content: space-around; align-items: center; height: var(--bottom-controls-height); padding: 0 10px; }
.control-button.swipe-button {
    background-color: transparent; border: 2px solid var(--global-text-color);
    color: var(--global-text-color); border-radius: 50%;
    width: 55px; height: 55px; font-size: 1.1rem; /* 文字サイズ少し調整 */ font-weight: bold;
    display: flex; align-items: center; justify-content: center;
    margin: 0 10px; transition: background-color 0.2s, transform 0.1s;
    padding: 0;
}
.control-button.swipe-button:hover { background-color: rgba(255,255,255,0.1); }
.control-button.swipe-button:active { transform: scale(0.95); }
.control-button.nope-button { border-color: var(--nope-overlay-color); color: var(--nope-overlay-color); }
.control-button.like-button { border-color: var(--like-overlay-color); color: var(--like-overlay-color); }

/* --- モーダル --- */
.modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.85); animation: modalFadeIn 0.2s ease-out; }
@keyframes modalFadeIn { from { opacity: 0; } to { opacity: 1; } }
.modal-content { background-color: #1e1e1e; color: var(--global-text-color); margin: 10vh auto; padding: 25px; border: 1px solid #333; width: 90%; max-width: 480px; border-radius: 10px; position: relative; box-shadow: 0 5px 20px rgba(0,0,0,0.6); animation: modalSlideIn 0.3s ease-out; }
@keyframes modalSlideIn { from { transform: translateY(-30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
.modal-close-button { color: #aaa; position: absolute; top: 10px; right: 15px; font-size: 32px; font-weight: bold; cursor: pointer; line-height: 1; }
.modal-close-button:hover, .modal-close-button:focus { color: #fff; }
.modal-content h2 { margin-top: 0; color: var(--global-text-color); text-align: center; font-size: 1.4rem; margin-bottom: 25px; font-weight: 500; }
.modal-body .setting-group { margin-bottom: 20px; padding-bottom: 18px; border-bottom: 1px solid #38383a; }
.modal-body .setting-group:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
.modal-body .setting-group h4 { color: #e0e0e0; font-size: 1.05rem; margin-bottom: 12px; font-weight: 500; }
.modal-body label { color: #d0d0d0; font-size: 0.9rem; user-select: none; }
.modal-body input[type="number"], .modal-body input[type="range"] { background-color: #3a3a3e; color: #fff; border: 1px solid #5a5a5f; padding: 8px 10px; border-radius: 4px; width: auto; }
.modal-body input[type="number"] { width: 70px; text-align: center; }
.modal-body .slider-container.member-sliders { display: grid; grid-template-columns: 1fr; gap: 12px; }
.modal-body .member-slider-item { display: flex; align-items: center; margin-bottom: 8px; }
.modal-body .member-slider-item label { min-width: 80px; text-align: left; margin-right: 10px; }
.modal-body input[type="range"] { flex-grow: 1; }
.modal-body .slider-value { background-color: #4a4a4e; color: #fff; padding: 3px 7px; border-radius: 4px; margin-left: 10px; font-size: 0.9em; }
.selection-note { font-size: 0.8rem; color: #999; margin-top: 8px; }
.modal-footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #38383a; }
.modal-footer .action-button { width: auto; padding: 10px 30px; background-color: var(--member-accent-color, #007bff); color: #fff;}
.modal-footer .action-button.secondary { background-color: #6c757d; }

/* --- 通知 --- */
.app-notification { position: fixed; top: 15px; left: 50%; transform: translateX(-50%); padding: 10px 20px; border-radius: 6px; color: #fff; font-size: 0.9em; z-index: 9999; box-shadow: 0 3px 8px rgba(0,0,0,0.3); opacity: 1; transition: opacity 0.4s ease-out, top 0.4s ease-out; }
.app-notification.notification-success { background-color: #38A169; }
.app-notification.notification-error { background-color: #E53E3E; }
.app-notification.notification-info { background-color: #3182CE; }

/* --- レスポンシブ対応 --- */
@media (max-width: 768px) {
    .side-info-panel.left-panel { left: 8px; bottom: calc(var(--serif-area-height) + var(--bottom-controls-height) + 15px + env(safe-area-inset-bottom)); gap: 12px; }
    .profile-icon-wrapper { width: 40px; height: 40px; }
    .action-icon-button { font-size: 24px; }
    .fever-gauge-container-vertical { height: 70px; }
    .settings-button-右上 { font-size: 1.3rem; top: 10px; right: 10px; }
    .serif-animation-container { height: calc(var(--serif-area-height) - 10px); }
    .serif-area { padding: 5px 10px; }
    .member-quote { font-size: 0.85em; }
    .image-tags-container { font-size: 0.6em; }
    .shikoshiko-box2-controls-only {}
    .main-controls { height: calc(var(--bottom-controls-height) - 5px); }
    .control-button.swipe-button { width: 50px; height: 50px; font-size: 1rem; margin: 0 8px;}
    .modal-content { width: 95%; margin: 5vh auto; padding: 20px; max-height: 90vh;}
}
